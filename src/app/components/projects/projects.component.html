<div class="card">
  <p-dataView #dv [value]="repositories" [rows]="6" [paginator]="true" [sortField]="sortField" [sortOrder]="sortOrder" [loading]="loading">
    <ng-template pTemplate="header">
      <div class="flex justify-content-end">
        <p-dropdown [options]="sortOptions" [(ngModel)]="sortKey" placeholder="Sort By" (onChange)="onSortChange($event)" styleClass="mb-2 md:mb-0"></p-dropdown>
      </div>
    </ng-template>
    <ng-template pTemplate="list" let-repositories>
      <div class="grid">
        <div *ngFor="let repo of repositories; let first = first" class="col-12 p-2">
          <div class="surface-card p-4 border-round shadow-2">
            <div class="flex flex-column md:flex-row align-items-start md:align-items-center justify-content-between gap-4">
              <div class="flex flex-column align-items-start flex-1">
                <div class="text-2xl font-bold text-900 mb-2">{{ repo.name }}</div>
                <p-tag [value]="repo.language" severity="info" [style]="{'margin-bottom': '0.5rem'}"></p-tag>
                <p class="text-600 line-height-3 mb-0" *ngIf="repo.description">{{ repo.description }}</p>
              </div>
              <div class="flex flex-column md:flex-row align-items-center gap-3">
                <div class="flex align-items-center gap-2">
                                    <span class="flex align-items-center justify-content-center bg-blue-100 text-blue-700 border-round" style="width: 2.5rem; height: 2.5rem;">
                                        <i class="pi pi-star-fill"></i>
                                    </span>
                  <span class="font-semibold">{{ repo.stargazers_count }}</span>
                </div>
                <div class="flex align-items-center gap-2">
                                    <span class="flex align-items-center justify-content-center bg-orange-100 text-orange-700 border-round" style="width: 2.5rem; height: 2.5rem;">
                                        <i class="pi pi-code-fork"></i>
                                    </span>
                  <span class="font-semibold">{{ repo.forks_count }}</span>
                </div>
                <p-button icon="pi pi-github" (onClick)="navigateToRepo(repo.html_url)" styleClass="p-button-rounded p-button-outlined" pTooltip="View on GitHub" tooltipPosition="top"></p-button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </ng-template>
    <ng-template pTemplate="empty">
      <div class="text-center p-4" *ngIf="!loading">
        <p>No projects found. There might be an issue fetching the data.</p>
      </div>
    </ng-template>
    <ng-template pTemplate="loadingItem">
      <div class="col-12 p-2">
        <div class="surface-card p-4 border-round shadow-2 animate-pulse">
          <div class="flex flex-column md:flex-row justify-content-between gap-4">
            <div class="flex-1">
              <div class="bg-gray-200 w-8 mb-2" style="height: 24px;"></div>
              <div class="bg-gray-200 w-6 mb-2" style="height: 18px;"></div>
              <div class="bg-gray-200 w-full" style="height: 60px;"></div>
            </div>
            <div class="flex flex-row gap-3">
              <div class="bg-gray-200 border-round" style="width: 40px; height: 40px;"></div>
              <div class="bg-gray-200 border-round" style="width: 40px; height: 40px;"></div>
              <div class="bg-gray-200 border-round" style="width: 40px; height: 40px;"></div>
            </div>
          </div>
        </div>
      </div>
    </ng-template>
  </p-dataView>
</div>
